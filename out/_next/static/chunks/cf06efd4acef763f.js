(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,33525,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"warnOnce",{enumerable:!0,get:function(){return a}});let a=e=>{}},18566,(e,t,r)=>{t.exports=e.r(76562)},15288,e=>{"use strict";e.s(["Card",()=>a,"CardContent",()=>l,"CardDescription",()=>i,"CardFooter",()=>d,"CardHeader",()=>s,"CardTitle",()=>n]);var t=e.i(43476),r=e.i(75157);function a(e){let{className:a,...s}=e;return(0,t.jsx)("div",{"data-slot":"card",className:(0,r.cn)("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",a),...s})}function s(e){let{className:a,...s}=e;return(0,t.jsx)("div",{"data-slot":"card-header",className:(0,r.cn)("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-1.5 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",a),...s})}function n(e){let{className:a,...s}=e;return(0,t.jsx)("div",{"data-slot":"card-title",className:(0,r.cn)("leading-none font-semibold",a),...s})}function i(e){let{className:a,...s}=e;return(0,t.jsx)("div",{"data-slot":"card-description",className:(0,r.cn)("text-muted-foreground text-sm",a),...s})}function l(e){let{className:a,...s}=e;return(0,t.jsx)("div",{"data-slot":"card-content",className:(0,r.cn)("px-6",a),...s})}function d(e){let{className:a,...s}=e;return(0,t.jsx)("div",{"data-slot":"card-footer",className:(0,r.cn)("flex items-center px-6 [.border-t]:pt-6",a),...s})}},19455,25913,e=>{"use strict";e.s(["Button",()=>c],19455);var t=e.i(43476),r=e.i(91918);e.s(["cva",()=>i],25913);var a=e.i(7670);let s=e=>"boolean"==typeof e?"".concat(e):0===e?"0":e,n=a.clsx,i=(e,t)=>r=>{var a;if((null==t?void 0:t.variants)==null)return n(e,null==r?void 0:r.class,null==r?void 0:r.className);let{variants:i,defaultVariants:l}=t,d=Object.keys(i).map(e=>{let t=null==r?void 0:r[e],a=null==l?void 0:l[e];if(null===t)return null;let n=s(t)||s(a);return i[e][n]}),c=r&&Object.entries(r).reduce((e,t)=>{let[r,a]=t;return void 0===a||(e[r]=a),e},{});return n(e,d,null==t||null==(a=t.compoundVariants)?void 0:a.reduce((e,t)=>{let{class:r,className:a,...s}=t;return Object.entries(s).every(e=>{let[t,r]=e;return Array.isArray(r)?r.includes({...l,...c}[t]):({...l,...c})[t]===r})?[...e,r,a]:e},[]),null==r?void 0:r.class,null==r?void 0:r.className)};var l=e.i(75157);let d=i("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-white hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2 has-[>svg]:px-3",sm:"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5",lg:"h-10 rounded-md px-6 has-[>svg]:px-4",icon:"size-9"}},defaultVariants:{variant:"default",size:"default"}});function c(e){let{className:a,variant:s,size:n,asChild:i=!1,...c}=e,o=i?r.Slot:"button";return(0,t.jsx)(o,{"data-slot":"button",className:(0,l.cn)(d({variant:s,size:n,className:a})),...c})}},71689,61659,e=>{"use strict";e.s(["ArrowLeft",()=>r],71689);var t=e.i(75254);let r=(0,t.default)("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);e.s(["CreditCard",()=>a],61659);let a=(0,t.default)("credit-card",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]])},76507,e=>{"use strict";e.s(["default",()=>y],76507);var t=e.i(43476),r=e.i(71645),a=e.i(18566),s=e.i(22794),n=e.i(15288),i=e.i(19455),l=e.i(75254);let d=(0,l.default)("shield-check",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);var c=e.i(71689),o=e.i(61659);let u=(0,l.default)("circle-alert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);var m=e.i(25913),x=e.i(75157);let h=(0,m.cva)("relative w-full rounded-lg border px-4 py-3 text-sm [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground [&>svg~*]:pl-7",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),p=r.forwardRef((e,r)=>{let{className:a,variant:s,...n}=e;return(0,t.jsx)("div",{ref:r,role:"alert",className:(0,x.cn)(h({variant:s}),a),...n})});p.displayName="Alert";let f=r.forwardRef((e,r)=>{let{className:a,...s}=e;return(0,t.jsx)("h5",{ref:r,className:(0,x.cn)("mb-1 font-medium leading-none tracking-tight",a),...s})});f.displayName="AlertTitle";let v=r.forwardRef((e,r)=>{let{className:a,...s}=e;return(0,t.jsx)("div",{ref:r,className:(0,x.cn)("text-sm [&_p]:leading-relaxed",a),...s})});v.displayName="AlertDescription";let g=["Details","Results","Payment"];function y(){let e=(0,a.useRouter)(),[l,m]=r.useState(null),[x,h]=r.useState(null),[y,b]=r.useState(!1),[j,N]=r.useState(null);r.useEffect(()=>{let t=sessionStorage.getItem("selectedPolicy"),r=sessionStorage.getItem("insuranceFormData");if(!t||!r)return void e.push("/results");try{m(JSON.parse(t)),h(JSON.parse(r))}catch(t){e.push("/results")}},[e]);let w=async()=>{if(l&&x){b(!0),N(null);try{let e="ORDER-".concat(Date.now(),"-").concat(Math.floor(1e3*Math.random())),t={detail:"Insurance_".concat(l.provider.name.replace(/\s+/g,"_"),"_").concat(l.id),amount:(1.06*l.finalPrice+10).toFixed(2),orderId:e,name:"Customer",email:x.email,phone:x.phoneNumber},r=await fetch("/api/payment/initiate",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!r.ok)throw Error("Failed to initiate payment");let a=await r.json(),s=document.createElement("form");s.method="POST",s.action=a.url;let n={detail:a.detail,amount:a.amount,order_id:a.orderId,hash:a.hash,name:a.name,email:a.email,phone:a.phone};Object.entries(n).forEach(e=>{let[t,r]=e;if(r){let e=document.createElement("input");e.type="hidden",e.name=t,e.value=r,s.appendChild(e)}}),document.body.appendChild(s),s.submit()}catch(e){console.error("Payment error:",e),N("Failed to connect to payment gateway. Please try again."),b(!1)}}};if(!l||!x)return null;let C=(1.06*l.finalPrice+10).toFixed(2);return(0,t.jsx)(s.PageLayout,{children:(0,t.jsxs)(s.CenteredLayout,{maxWidth:"max-w-4xl",children:[(0,t.jsx)(s.StepIndicator,{steps:g,currentStep:2}),(0,t.jsxs)("div",{className:"grid md:grid-cols-2 gap-8",children:[(0,t.jsx)("div",{className:"space-y-6 md:order-2",children:(0,t.jsxs)(n.Card,{className:"bg-muted/30",children:[(0,t.jsx)(n.CardHeader,{children:(0,t.jsx)(n.CardTitle,{children:"Order Summary"})}),(0,t.jsxs)(n.CardContent,{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"flex justify-between items-start pb-4 border-b",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"font-semibold",children:l.provider.name}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:"Comprehensive Coverage"})]}),(0,t.jsx)("div",{className:"text-right",children:(0,t.jsxs)("span",{className:"font-bold text-lg",children:["RM",l.finalPrice.toFixed(2)]})})]}),(0,t.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-muted-foreground",children:"Base Premium"}),(0,t.jsxs)("span",{children:["RM",l.originalPrice.toFixed(2)]})]}),l.discountPercentage&&(0,t.jsxs)("div",{className:"flex justify-between text-green-600",children:[(0,t.jsxs)("span",{children:["Discount (",l.discountPercentage,"%)"]}),(0,t.jsxs)("span",{children:["-RM",(l.originalPrice-l.finalPrice).toFixed(2)]})]}),(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-muted-foreground",children:"Service Tax (6%)"}),(0,t.jsxs)("span",{children:["RM",(.06*l.finalPrice).toFixed(2)]})]}),(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-muted-foreground",children:"Stamp Duty"}),(0,t.jsx)("span",{children:"RM10.00"})]})]}),(0,t.jsxs)("div",{className:"pt-4 border-t flex justify-between items-center",children:[(0,t.jsx)("span",{className:"font-bold text-lg",children:"Total"}),(0,t.jsxs)("span",{className:"font-bold text-2xl text-primary",children:["RM",C]})]})]})]})}),(0,t.jsx)("div",{className:"space-y-6 md:order-1",children:(0,t.jsxs)(n.Card,{className:"h-full",children:[(0,t.jsxs)(n.CardHeader,{children:[(0,t.jsx)(n.CardTitle,{children:"Secure Payment"}),(0,t.jsx)(n.CardDescription,{children:"You will be redirected to SenangPay secure payment gateway to complete your purchase."})]}),(0,t.jsxs)(n.CardContent,{className:"space-y-6",children:[j&&(0,t.jsxs)(p,{variant:"destructive",children:[(0,t.jsx)(u,{className:"h-4 w-4"}),(0,t.jsx)(f,{children:"Error"}),(0,t.jsx)(v,{children:j})]}),(0,t.jsx)("div",{className:"rounded-lg border p-4 bg-blue-50/50 border-blue-100",children:(0,t.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,t.jsx)(d,{className:"w-5 h-5 text-blue-600 mt-0.5"}),(0,t.jsxs)("div",{className:"space-y-1",children:[(0,t.jsx)("h4",{className:"text-sm font-semibold text-blue-900",children:"Safe & Secure"}),(0,t.jsx)("p",{className:"text-xs text-blue-700",children:"Your payment information is encrypted and processed securely by SenangPay. We do not store your card details."})]})]})}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"text-sm text-muted-foreground",children:[(0,t.jsx)("span",{className:"font-medium text-foreground",children:"Payer Email:"})," ",x.email]}),(0,t.jsxs)("div",{className:"text-sm text-muted-foreground",children:[(0,t.jsx)("span",{className:"font-medium text-foreground",children:"Payer Phone:"})," ",x.phoneNumber]})]})]}),(0,t.jsxs)(n.CardFooter,{className:"flex-col space-y-4",children:[(0,t.jsx)(i.Button,{onClick:w,className:"w-full h-12 text-lg bg-[#38b2ac] hover:bg-[#319795]",disabled:y,children:y?(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),(0,t.jsx)("span",{children:"Redirecting..."})]}):(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)(o.CreditCard,{className:"w-5 h-5"}),(0,t.jsx)("span",{children:"Pay with SenangPay"})]})}),(0,t.jsxs)(i.Button,{variant:"ghost",className:"w-full",onClick:()=>e.back(),disabled:y,children:[(0,t.jsx)(c.ArrowLeft,{className:"w-4 h-4 mr-2"}),"Back to Results"]})]})]})})]})]})})}}]);