(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[58],{63:(e,t,s)=>{"use strict";var a=s(7260);s.o(a,"useRouter")&&s.d(t,{useRouter:function(){return a.useRouter}}),s.o(a,"useSearchParams")&&s.d(t,{useSearchParams:function(){return a.useSearchParams}})},2529:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(1847).A)("circle-check-big",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},3101:(e,t,s)=>{"use strict";s.d(t,{F:()=>l});var a=s(2821);let r=e=>"boolean"==typeof e?`${e}`:0===e?"0":e,n=a.$,l=(e,t)=>s=>{var a;if((null==t?void 0:t.variants)==null)return n(e,null==s?void 0:s.class,null==s?void 0:s.className);let{variants:l,defaultVariants:c}=t,i=Object.keys(l).map(e=>{let t=null==s?void 0:s[e],a=null==c?void 0:c[e];if(null===t)return null;let n=r(t)||r(a);return l[e][n]}),d=s&&Object.entries(s).reduce((e,t)=>{let[s,a]=t;return void 0===a||(e[s]=a),e},{});return n(e,i,null==t||null==(a=t.compoundVariants)?void 0:a.reduce((e,t)=>{let{class:s,className:a,...r}=t;return Object.entries(r).every(e=>{let[t,s]=e;return Array.isArray(s)?s.includes({...c,...d}[t]):({...c,...d})[t]===s})?[...e,s,a]:e},[]),null==s?void 0:s.class,null==s?void 0:s.className)}},4524:(e,t,s)=>{"use strict";s.d(t,{Ir:()=>c,e1:()=>l,iB:()=>n});let a="136175265133530",r="SK-IHRzWygdRgIPOiq9leu7",n={merchantId:a,secretKey:r,url:"https://sandbox.senangpay.my/payment/"+a};async function l(e,t,s){return await i(r,r+e+t+s)}async function c(e,t,s,a,n){return await i(r,r+e+t+s+a)===n}async function i(e,t){let s=new TextEncoder,a=s.encode(e),r=s.encode(t),n=await crypto.subtle.importKey("raw",a,{name:"HMAC",hash:"SHA-256"},!1,["sign"]);return Array.from(new Uint8Array(await crypto.subtle.sign("HMAC",n,r))).map(e=>e.toString(16).padStart(2,"0")).join("")}},5993:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(1847).A)("house",[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-6a2 2 0 0 1 2.582 0l7 6A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"r6nss1"}]])},7038:(e,t,s)=>{Promise.resolve().then(s.bind(s,7718))},7718:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>p});var a=s(5155),r=s(2115),n=s(63),l=s(5783),c=s(6948),i=s(3998),d=s(2529),u=s(1847);let o=(0,u.A)("circle-x",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]),m=(0,u.A)("refresh-ccw",[["path",{d:"M21 12a9 9 0 0 0-9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"14sxne"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M3 12a9 9 0 0 0 9 9 9.75 9.75 0 0 0 6.74-2.74L21 16",key:"1hlbsb"}],["path",{d:"M16 16h5v5",key:"ccwih5"}]]);var h=s(5993),x=s(4524),y=s(4269);function f(){let e=(0,n.useRouter)(),t=(0,n.useSearchParams)(),[s,u]=r.useState("loading"),[f,p]=r.useState("");return(r.useEffect(()=>{let s=t.get("status_id"),a=t.get("msg"),r=t.get("transaction_id"),n=t.get("order_id"),l=t.get("hash");if(!s||!l){u("failed"),p("Invalid payment response.");return}(async()=>{try{await (0,x.Ir)(s,n||"",r||"",a||"",l)?"1"===s?(u("success"),setTimeout(()=>{e.push((0,y.aD)("/thank-you"))},1500)):(u("failed"),p(a?a.replace(/_/g," "):"Payment failed")):(u("failed"),p("Security verification failed. Data may be tampered."))}catch(e){console.error("Verification error:",e),u("failed"),p("Error verifying payment status.")}})()},[t,e]),"loading"===s)?(0,a.jsx)(l.Lm,{maxWidth:"max-w-md",children:(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center space-y-4 p-8",children:[(0,a.jsx)("div",{className:"w-12 h-12 border-4 border-primary border-t-transparent rounded-full animate-spin"}),(0,a.jsx)("h2",{className:"text-xl font-semibold",children:"Verifying Payment..."}),(0,a.jsx)("p",{className:"text-muted-foreground text-center",children:"Please do not close this window."})]})}):"success"===s?(0,a.jsx)(l.Lm,{maxWidth:"max-w-md",children:(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center space-y-4 p-8",children:[(0,a.jsx)(d.A,{className:"w-16 h-16 text-green-500"}),(0,a.jsx)("h2",{className:"text-2xl font-bold text-green-600",children:"Payment Successful!"}),(0,a.jsx)("p",{className:"text-center text-muted-foreground",children:"Redirecting you to confirmation page..."})]})}):(0,a.jsx)(l.Lm,{maxWidth:"max-w-lg",children:(0,a.jsxs)(c.Zp,{className:"border-destructive/50",children:[(0,a.jsxs)(c.aR,{className:"text-center",children:[(0,a.jsx)("div",{className:"mx-auto w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mb-4",children:(0,a.jsx)(o,{className:"w-8 h-8 text-red-600"})}),(0,a.jsx)(c.ZB,{className:"text-2xl text-red-600",children:"Payment Failed"})]}),(0,a.jsxs)(c.Wu,{className:"text-center space-y-4",children:[(0,a.jsx)("p",{className:"text-lg font-medium",children:f}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"We couldn't process your payment. Please try again or use a different payment method."})]}),(0,a.jsxs)(c.wL,{className:"flex flex-col space-y-3",children:[(0,a.jsxs)(i.$,{className:"w-full",onClick:()=>e.push((0,y.aD)("/payment")),children:[(0,a.jsx)(m,{className:"w-4 h-4 mr-2"}),"Try Again"]}),(0,a.jsxs)(i.$,{variant:"outline",className:"w-full",onClick:()=>e.push((0,y.aD)("/")),children:[(0,a.jsx)(h.A,{className:"w-4 h-4 mr-2"}),"Return to Home"]})]})]})})}function p(){return(0,a.jsx)(l.Mx,{children:(0,a.jsx)(r.Suspense,{fallback:(0,a.jsx)(l.Lm,{maxWidth:"max-w-md",children:(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center space-y-4 p-8",children:[(0,a.jsx)("div",{className:"w-12 h-12 border-4 border-primary border-t-transparent rounded-full animate-spin"}),(0,a.jsx)("h2",{className:"text-xl font-semibold",children:"Loading..."})]})}),children:(0,a.jsx)(f,{})})})}}},e=>{e.O(0,[887,309,441,255,358],()=>e(e.s=7038)),_N_E=e.O()}]);