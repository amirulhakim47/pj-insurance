(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[407],{63:(e,s,t)=>{"use strict";var r=t(7260);t.o(r,"useRouter")&&t.d(s,{useRouter:function(){return r.useRouter}}),t.o(r,"useSearchParams")&&t.d(s,{useSearchParams:function(){return r.useSearchParams}})},2131:(e,s,t)=>{Promise.resolve().then(t.bind(t,7714))},3101:(e,s,t)=>{"use strict";t.d(s,{F:()=>n});var r=t(2821);let a=e=>"boolean"==typeof e?`${e}`:0===e?"0":e,l=r.$,n=(e,s)=>t=>{var r;if((null==s?void 0:s.variants)==null)return l(e,null==t?void 0:t.class,null==t?void 0:t.className);let{variants:n,defaultVariants:i}=s,c=Object.keys(n).map(e=>{let s=null==t?void 0:t[e],r=null==i?void 0:i[e];if(null===s)return null;let l=a(s)||a(r);return n[e][l]}),d=t&&Object.entries(t).reduce((e,s)=>{let[t,r]=s;return void 0===r||(e[t]=r),e},{});return l(e,c,null==s||null==(r=s.compoundVariants)?void 0:r.reduce((e,s)=>{let{class:t,className:r,...a}=s;return Object.entries(a).every(e=>{let[s,t]=e;return Array.isArray(t)?t.includes({...i,...d}[s]):({...i,...d})[s]===t})?[...e,t,r]:e},[]),null==t?void 0:t.class,null==t?void 0:t.className)}},4524:(e,s,t)=>{"use strict";t.d(s,{Ir:()=>i,e1:()=>n,iB:()=>l});let r="136175265133530",a="SK-IHRzWygdRgIPOiq9leu7",l={merchantId:r,secretKey:a,url:"https://sandbox.senangpay.my/payment/"+r};async function n(e,s,t){return await c(a,a+e+s+t)}async function i(e,s,t,r,l){return await c(a,a+e+s+t+r)===l}async function c(e,s){let t=new TextEncoder,r=t.encode(e),a=t.encode(s),l=await crypto.subtle.importKey("raw",r,{name:"HMAC",hash:"SHA-256"},!1,["sign"]);return Array.from(new Uint8Array(await crypto.subtle.sign("HMAC",l,a))).map(e=>e.toString(16).padStart(2,"0")).join("")}},5626:(e,s,t)=>{"use strict";t.d(s,{A:()=>r});let r=(0,t(1847).A)("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},7714:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>b});var r=t(5155),a=t(2115),l=t(63),n=t(5783),i=t(6948),c=t(3998),d=t(1847);let o=(0,d.A)("circle-alert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]),u=(0,d.A)("shield-check",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);var m=t(8519),x=t(5626),h=t(3101),p=t(4269);let f=(0,h.F)("relative w-full rounded-lg border px-4 py-3 text-sm [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground [&>svg~*]:pl-7",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),y=a.forwardRef((e,s)=>{let{className:t,variant:a,...l}=e;return(0,r.jsx)("div",{ref:s,role:"alert",className:(0,p.cn)(f({variant:a}),t),...l})});y.displayName="Alert";let j=a.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,r.jsx)("h5",{ref:s,className:(0,p.cn)("mb-1 font-medium leading-none tracking-tight",t),...a})});j.displayName="AlertTitle";let v=a.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,r.jsx)("div",{ref:s,className:(0,p.cn)("text-sm [&_p]:leading-relaxed",t),...a})});v.displayName="AlertDescription";var g=t(4524);let N=["Details","Results","Payment"];function b(){let e=(0,l.useRouter)(),[s,t]=a.useState(null),[d,h]=a.useState(null),[f,b]=a.useState(!1),[w,P]=a.useState(null);a.useEffect(()=>{let s=sessionStorage.getItem("selectedPolicy"),r=sessionStorage.getItem("insuranceFormData");if(!s||!r)return void e.push((0,p.aD)("/results"));try{t(JSON.parse(s)),h(JSON.parse(r))}catch(s){e.push((0,p.aD)("/results"))}},[e]);let S=async()=>{if(s&&d){b(!0),P(null);try{let e="ORDER-".concat(Date.now(),"-").concat(Math.floor(1e3*Math.random())),t=(1.06*s.finalPrice+10).toFixed(2),r="Insurance_".concat(s.provider.name.replace(/\s+/g,"_"),"_").concat(s.id),a=await (0,g.e1)(r,t,e),l=document.createElement("form");l.method="POST",l.action=g.iB.url;let n={detail:r,amount:t,order_id:e,hash:a,name:"Customer",email:d.email,phone:d.phoneNumber};Object.entries(n).forEach(e=>{let[s,t]=e;if(t){let e=document.createElement("input");e.type="hidden",e.name=s,e.value=t,l.appendChild(e)}}),document.body.appendChild(l),l.submit()}catch(e){console.error("Payment error:",e),P("Failed to process payment request. Please try again."),b(!1)}}};if(!s||!d)return null;let k=(1.06*s.finalPrice+10).toFixed(2);return(0,r.jsx)(n.Mx,{children:(0,r.jsxs)(n.Lm,{maxWidth:"max-w-4xl",children:[(0,r.jsx)(n.SK,{steps:N,currentStep:2}),(0,r.jsxs)("div",{className:"grid md:grid-cols-2 gap-8 items-stretch",children:[(0,r.jsx)("div",{className:"space-y-6 md:order-2 flex flex-col",children:(0,r.jsxs)(i.Zp,{className:"bg-muted/30 h-full",children:[(0,r.jsx)(i.aR,{children:(0,r.jsx)(i.ZB,{children:"Order Summary"})}),(0,r.jsxs)(i.Wu,{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"flex justify-between items-start pb-4 border-b",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"font-semibold",children:s.provider.name}),(0,r.jsx)("p",{className:"text-sm text-muted-foreground",children:"Comprehensive Coverage"})]}),(0,r.jsx)("div",{className:"text-right",children:(0,r.jsxs)("span",{className:"font-bold text-lg",children:["RM",s.finalPrice.toFixed(2)]})})]}),(0,r.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,r.jsxs)("div",{className:"flex justify-between",children:[(0,r.jsx)("span",{className:"text-muted-foreground",children:"Base Premium"}),(0,r.jsxs)("span",{children:["RM",s.originalPrice.toFixed(2)]})]}),s.discountPercentage&&(0,r.jsxs)("div",{className:"flex justify-between text-green-600",children:[(0,r.jsxs)("span",{children:["Discount (",s.discountPercentage,"%)"]}),(0,r.jsxs)("span",{children:["-RM",(s.originalPrice-s.finalPrice).toFixed(2)]})]}),(0,r.jsxs)("div",{className:"flex justify-between",children:[(0,r.jsx)("span",{className:"text-muted-foreground",children:"Service Tax (6%)"}),(0,r.jsxs)("span",{children:["RM",(.06*s.finalPrice).toFixed(2)]})]}),(0,r.jsxs)("div",{className:"flex justify-between",children:[(0,r.jsx)("span",{className:"text-muted-foreground",children:"Stamp Duty"}),(0,r.jsx)("span",{children:"RM10.00"})]})]}),(0,r.jsxs)("div",{className:"pt-4 border-t flex justify-between items-center",children:[(0,r.jsx)("span",{className:"font-bold text-lg",children:"Total"}),(0,r.jsxs)("span",{className:"font-bold text-2xl text-primary",children:["RM",k]})]})]})]})}),(0,r.jsx)("div",{className:"space-y-6 md:order-1 flex flex-col",children:(0,r.jsxs)(i.Zp,{className:"h-full flex flex-col",children:[(0,r.jsxs)(i.aR,{children:[(0,r.jsx)(i.ZB,{children:"Secure Payment"}),(0,r.jsx)(i.BT,{children:"You will be redirected to SenangPay secure payment gateway to complete your purchase."})]}),(0,r.jsxs)(i.Wu,{className:"space-y-6 flex-grow",children:[w&&(0,r.jsxs)(y,{variant:"destructive",children:[(0,r.jsx)(o,{className:"h-4 w-4"}),(0,r.jsx)(j,{children:"Error"}),(0,r.jsx)(v,{children:w})]}),(0,r.jsx)("div",{className:"rounded-lg border p-4 bg-blue-50/50 border-blue-100",children:(0,r.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,r.jsx)(u,{className:"w-5 h-5 text-blue-600 mt-0.5"}),(0,r.jsxs)("div",{className:"space-y-1",children:[(0,r.jsx)("h4",{className:"text-sm font-semibold text-blue-900",children:"Safe & Secure"}),(0,r.jsx)("p",{className:"text-xs text-blue-700",children:"Your payment information is encrypted and processed securely by SenangPay. We do not store your card details."})]})]})}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"text-sm text-muted-foreground",children:[(0,r.jsx)("span",{className:"font-medium text-foreground",children:"Payer Email:"})," ",d.email]}),(0,r.jsxs)("div",{className:"text-sm text-muted-foreground",children:[(0,r.jsx)("span",{className:"font-medium text-foreground",children:"Payer Phone:"})," ",d.phoneNumber]})]})]}),(0,r.jsxs)(i.wL,{className:"flex-col space-y-4 mt-auto",children:[(0,r.jsx)(c.$,{onClick:S,className:"w-full h-12 text-lg bg-[#38b2ac] hover:bg-[#319795]",disabled:f,children:f?(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),(0,r.jsx)("span",{children:"Redirecting..."})]}):(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)(m.A,{className:"w-5 h-5"}),(0,r.jsx)("span",{children:"Pay with SenangPay"})]})}),(0,r.jsxs)(c.$,{variant:"ghost",className:"w-full",onClick:()=>e.back(),disabled:f,children:[(0,r.jsx)(x.A,{className:"w-4 h-4 mr-2"}),"Back to Results"]})]})]})})]})]})})}},8519:(e,s,t)=>{"use strict";t.d(s,{A:()=>r});let r=(0,t(1847).A)("credit-card",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]])}},e=>{e.O(0,[887,309,441,255,358],()=>e(e.s=2131)),_N_E=e.O()}]);